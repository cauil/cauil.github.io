<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>深入理解Javascript：DOM事件之事件传播 | Cauil&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="客户端Javascript程序采用异步事件驱动编程模型。 那首先什么是异步事件驱动编程模型呢？ 在这种设计风格下，当文档、浏览器、元素或与之相关的对象发生某些有趣的事情时，Web浏览器就会产生事件。 这些对象等待事件发生，然后他们相应，这就是所谓的异步驱动风格。 1.事件是什么呢？事件就是Web浏览器通知应用程序发生了什么事情。 事件类型：是一个用来说明发生什么类型事件的字符串；例如‘mousem">
<meta name="keywords" content="javascript">
<meta property="og:type" content="article">
<meta property="og:title" content="深入理解Javascript：DOM事件之事件传播">
<meta property="og:url" content="http://cauil.github.io/2015/10/19/DiveIntoJs_Events_propagation/index.html">
<meta property="og:site_name" content="Cauil&#39;blog">
<meta property="og:description" content="客户端Javascript程序采用异步事件驱动编程模型。 那首先什么是异步事件驱动编程模型呢？ 在这种设计风格下，当文档、浏览器、元素或与之相关的对象发生某些有趣的事情时，Web浏览器就会产生事件。 这些对象等待事件发生，然后他们相应，这就是所谓的异步驱动风格。 1.事件是什么呢？事件就是Web浏览器通知应用程序发生了什么事情。 事件类型：是一个用来说明发生什么类型事件的字符串；例如‘mousem">
<meta property="og:image" content="http://7xj29n.com1.z0.glb.clouddn.com/事件传播.jpg">
<meta property="og:updated_time" content="2017-10-10T15:17:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入理解Javascript：DOM事件之事件传播">
<meta name="twitter:description" content="客户端Javascript程序采用异步事件驱动编程模型。 那首先什么是异步事件驱动编程模型呢？ 在这种设计风格下，当文档、浏览器、元素或与之相关的对象发生某些有趣的事情时，Web浏览器就会产生事件。 这些对象等待事件发生，然后他们相应，这就是所谓的异步驱动风格。 1.事件是什么呢？事件就是Web浏览器通知应用程序发生了什么事情。 事件类型：是一个用来说明发生什么类型事件的字符串；例如‘mousem">
<meta name="twitter:image" content="http://7xj29n.com1.z0.glb.clouddn.com/事件传播.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Cauil&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Cauil&#39;blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://cauil.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-DiveIntoJs_Events_propagation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/19/DiveIntoJs_Events_propagation/" class="article-date">
  <time datetime="2015-10-18T16:00:00.000Z" itemprop="datePublished">2015-10-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      深入理解Javascript：DOM事件之事件传播
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>客户端Javascript程序采用异步事件驱动编程模型。</p>
<p>那首先什么是异步事件驱动编程模型呢？</p>
<p>在这种设计风格下，当文档、浏览器、元素或与之相关的对象发生某些有趣的事情时，Web浏览器就会产生事件。</p>
<p>这些对象等待事件发生，然后他们相应，这就是所谓的异步驱动风格。</p>
<h2 id="1-事件是什么呢？"><a href="#1-事件是什么呢？" class="headerlink" title="1.事件是什么呢？"></a>1.事件是什么呢？</h2><p>事件就是Web浏览器通知应用程序发生了什么事情。</p>
<p>事件类型：是一个用来说明发生什么类型事件的字符串；例如‘mousemove’表示用户移动鼠标，由于事件类型只是一个字符串，有时也可称为事件名字。</p>
<p>事件目标：发生的事件或者与之相关的对象。在JS应用程序中，Windows、Document、Element对象是最常见的事件目标。</p>
<p>下面的代码就是弹出事件目标与类型的方法：</p>
<pre><code>&lt;div id=&apos;box&apos;&gt;
    &lt;button&gt;按钮&lt;/button&gt;
&lt;/div&gt;
&lt;script&gt;
    var bt = document.getElementsByTagName(&apos;button&apos;)[0];

    bt.addEventListener(&apos;click&apos;,function(event){
        alert(&apos;事件目标:&apos; + event.target);
        alert(&apos;事件类型：&apos; + event.type);
    })
&lt;/script&gt;
</code></pre><p>事件处理程序：处理或相应事件的函数。当在特定的事件目标上发生特定类型的事件时，浏览器会调用对应的事件处理程序。</p>
<p>事件对象：与特定事件相关且包含有关该事件详细信息的对象；例如，鼠标事件的相关对象会包含鼠标指针的坐标。</p>
<p>事件传播：浏览器决定哪个对象触发其事件处理程序的过程：</p>
<ul>
<li>对于单个对象的特定事件（比如windows的load事件），必须是不能传播的；</li>
<li>事件传播向上传播，即冒泡传播；</li>
<li>事件处理程序能够通过调用方法或者设置事件对象属性来阻止事件传播，这样就能停止冒泡；</li>
</ul>
<p>事件捕获：事件传播的另外一种形式，在容器元素上注册的特定处理程序有机会在事件传播到真实目标之前捕获它。IE8或之前的版本不支持事件捕获，所以不常用它。</p>
<h2 id="2-事件传播"><a href="#2-事件传播" class="headerlink" title="2.事件传播"></a>2.事件传播</h2><p>上面介绍了什么是事件，下面详细介绍事件的传播机制；</p>
<p>当事件目标是Windows对象或其他的一些单独对象（如XMLHTTPRequest）时，浏览器简单的通过调用对象上适当的处理程序相应事件。</p>
<p>当事件目标是文档或者文档元素时，情况不同：</p>
<p>事件传播有三个阶段：</p>
<p>捕获阶段，发生在目标处理程序调用之前，称为‘捕获’阶段，为<strong>第一阶段</strong>；</p>
<p>目标对象本身的时间处理程序调用是<strong>第二个阶段</strong>；</p>
<p>事件冒泡是事件传播的<strong>第三个阶段</strong>；</p>
<p><img src="http://7xj29n.com1.z0.glb.clouddn.com/事件传播.jpg" alt="http://7xj29n.com1.z0.glb.clouddn.com/事件传播.jpg"></p>
<h2 id="3-事件冒泡"><a href="#3-事件冒泡" class="headerlink" title="3.事件冒泡"></a>3.事件冒泡</h2><p>事件最开始由具体的元素（即事件发生的对象）接受，然后逐级向上传播至最不具体的那个节点。</p>
<p>下面是html：</p>
<pre><code>&lt;body&gt;
    &lt;div id=&apos;box&apos;&gt;
        &lt;button&gt;按钮&lt;/button&gt;
    &lt;/div&gt;
&lt;/body&gt;
</code></pre><p>比如当点击上面HTML中的按钮，事件会一直向上冒泡，寻找注册了clink的事件处理程序的元素：</p>
<pre><code>button --&gt;　box --&gt;　body --&gt; html --&gt; document root
</code></pre><h2 id="4-事件捕获"><a href="#4-事件捕获" class="headerlink" title="4.事件捕获"></a>4.事件捕获</h2><p>事件捕获像反向的冒泡阶段；最先调用windows对象的捕获处理程序，然后是Document对象的捕获处理程序，接着是body对象的，再然后是DOM树向下，依次类推，直到调用事件目标的父元素的捕获事件处理程序。</p>
<p>事件捕获只能用于addEventListener()注册且第三个参数是true的事件处理程序中。意味着事件捕获无法在IE9之前的IE中使用。因为IE9之前的IE中不支持addEventListener。</p>
<pre><code>&lt;body&gt;
    &lt;div id=&apos;box&apos;&gt;
        &lt;button&gt;按钮&lt;/button&gt;
    &lt;/div&gt;
&lt;/body&gt;
</code></pre><p>当点击上面html的按钮时，事件捕获阶段会从上到下寻找注册了click事件捕获处理程序的元素：</p>
<pre><code>document root --&gt; html --&gt; body --&gt; box --&gt; button
</code></pre><h2 id="5-事件的取消"><a href="#5-事件的取消" class="headerlink" title="5.事件的取消"></a>5.事件的取消</h2><p>取消事件的浏览器默认操作有三种方式：</p>
<ul>
<li>设置事件处理程序的返回值为false；</li>
<li>在支持addEventListener的浏览器中，也能通过调用事件对象的preventDefault()方法取消事件的默认行为</li>
<li>在IE9之前的IE中，可以设置事件对象的returnValue属性为false</li>
</ul>
<p>取消事件的传播可以通过：</p>
<ul>
<li>在支持addEventListener的浏览器中，也能通过调用事件对象的一个stopPropagation()方法取消事件的继续传播；如果在同一对象上定义了其他处理程序，剩下的处理程序将依旧被调用，但调用stopPropagation方法之后其他任何对象的事件处理程序将不会调用</li>
<li>IE9之前不支持上一种方法的可以通过IE事件对象的cancelBubble属性设置为true能阻止事件进一步冒泡（这些版本事件传播不支持事件的捕获阶段）</li>
</ul>
<h2 id="6-综合例子"><a href="#6-综合例子" class="headerlink" title="6.综合例子"></a>6.综合例子</h2><p>下面是一个综合例子：</p>
<p>当点击按钮时，会依次弹出对话框：‘事件捕获阶段body’、‘事件捕获阶段box’、‘事件捕获阶段：button’、‘事件调用阶段：button’、‘事件冒泡阶段：box’、‘事件冒泡阶段：body’；</p>
<p>当点击box时，会依次弹出对话框：‘事件捕获阶段body’、‘事件捕获阶段box’、‘事件冒泡阶段：box’、‘事件冒泡阶段：body’；</p>
<pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;事件流&lt;/title&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;style&gt;
            #box {height:100px;width: 100px;border: solid 1px red; text-align: center;background-color: burlywood}
            #button {border: solid 1px red;}
        &lt;/style&gt;
    &lt;/head&gt;

    &lt;body id=&quot;body&quot;&gt;
        &lt;div id=&quot;box&quot;&gt;box
            &lt;button id=&quot;button&quot;&gt;按钮&lt;/button&gt;
        &lt;/div&gt;
        &lt;script&gt;
            var bt = document.getElementById(&apos;button&apos;);
            var bx = document.getElementById(&apos;box&apos;);
            var bd = document.getElementById(&apos;body&apos;);

            bt.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件捕获阶段：button&quot;);
            }, true);
            bx.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件捕获阶段box&quot;);
            },true);
            bd.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件捕获阶段body&quot;);
                // event.stopPropagation();
            },true);

            bt.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件调用阶段：button&quot;);
            }, false);
            bx.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件冒泡阶段：box&quot;);
            },false);
            bd.addEventListener(&apos;click&apos;, function(){
                alert(&quot;事件冒泡阶段：body&quot;);
            },false);
        &lt;/script&gt;
    &lt;/body&gt;

&lt;/html&gt;
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://cauil.github.io/2015/10/19/DiveIntoJs_Events_propagation/" data-id="cj8me9zv40001rmsc5bgmbxd9" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/19/DiveIntoJs_compare/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          深入理解Javascript： 比较
        
      </div>
    </a>
  
  
    <a href="/2015/09/22/css_notes_3-overflow/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">CSS：overflow</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Catégories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书/">读书</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/移动端/" style="font-size: 10px;">移动端</a> <a href="/tags/读书/" style="font-size: 10px;">读书</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/10/10/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/10/01/从尺寸单位到移动端适配方案/">从尺寸单位到移动端适配方案</a>
          </li>
        
          <li>
            <a href="/2016/02/21/linkedList/">leetcode之linked list</a>
          </li>
        
          <li>
            <a href="/2015/12/27/DiveIntoJs_core/">深入理解Javascript： JavaScript核心</a>
          </li>
        
          <li>
            <a href="/2015/12/15/DiveIntoJs_module_pattern/">深入理解Javascript：模块模式</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 cauil<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>