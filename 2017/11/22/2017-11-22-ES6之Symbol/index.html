<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="JS,ES6," />










<meta name="description" content="ES6引入了第6种原始类型：Symbol。起初，人们用它来创建对象的私有成员；在Symbol出现之前，人们一直通过属性名来访问所有属性，无论属性名由什么元素构成，全部通过一个字符串类型的名称来访问。 私有名称原本是为了让开发者创建非字符串属性名称而设计的，但是一般的技术无法检测这些属性的私有名称。 创建Symbol可以通过全局的Symbol函数创建一个Symbol： 1234let firstNa">
<meta name="keywords" content="JS,ES6">
<meta property="og:type" content="article">
<meta property="og:title" content="ES6之Symbol">
<meta property="og:url" content="http://cauil.github.io/2017/11/22/2017-11-22-ES6之Symbol/index.html">
<meta property="og:site_name" content="Cauil&#39;s Blog">
<meta property="og:description" content="ES6引入了第6种原始类型：Symbol。起初，人们用它来创建对象的私有成员；在Symbol出现之前，人们一直通过属性名来访问所有属性，无论属性名由什么元素构成，全部通过一个字符串类型的名称来访问。 私有名称原本是为了让开发者创建非字符串属性名称而设计的，但是一般的技术无法检测这些属性的私有名称。 创建Symbol可以通过全局的Symbol函数创建一个Symbol： 1234let firstNa">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-11-21T22:59:44.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ES6之Symbol">
<meta name="twitter:description" content="ES6引入了第6种原始类型：Symbol。起初，人们用它来创建对象的私有成员；在Symbol出现之前，人们一直通过属性名来访问所有属性，无论属性名由什么元素构成，全部通过一个字符串类型的名称来访问。 私有名称原本是为了让开发者创建非字符串属性名称而设计的，但是一般的技术无法检测这些属性的私有名称。 创建Symbol可以通过全局的Symbol函数创建一个Symbol： 1234let firstNa">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://cauil.github.io/2017/11/22/2017-11-22-ES6之Symbol/"/>





  <title>ES6之Symbol | Cauil's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Cauil's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">陌上花开，可缓缓归矣</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://cauil.github.io/2017/11/22/2017-11-22-ES6之Symbol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="cauil">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/abu.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cauil's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ES6之Symbol</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-22T00:00:00+08:00">
                2017-11-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JS/" itemprop="url" rel="index">
                    <span itemprop="name">JS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>ES6引入了第6种原始类型：Symbol。起初，人们用它来创建对象的私有成员；在Symbol出现之前，人们一直通过属性名来访问所有属性，无论属性名由什么元素构成，全部通过一个字符串类型的名称来访问。</p>
<p>私有名称原本是为了让开发者<strong>创建非字符串属性名称而设计</strong>的，但是<strong>一般的技术无法检测这些属性的私有名称</strong>。</p>
<h2 id="创建Symbol"><a href="#创建Symbol" class="headerlink" title="创建Symbol"></a>创建Symbol</h2><p>可以通过全局的Symbol函数创建一个Symbol：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">let firstName = Symbol();</div><div class="line">let person = &#123;&#125;;</div><div class="line">person[firstName] = &quot;Nicholas&quot;;</div><div class="line">console.log(person[firstName]);</div></pre></td></tr></table></figure>
<p>由于Symbol是原始值，因此调用new Symbol()会导致程序抛出错误。</p>
<p>Symbol接受一个可选参数，其可以添加一段文本描述即将创建的Symbol，这段描述不可以用作属性访问，只是为了便于阅读和调试Symbol程序；symbol的描述被存储在内部的[[Description]]属性中，只有当调用Symbol的toString()方法时才可以读取这个属性；</p>
<p>检测一个Symbol：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let name = Symbol(&apos;hi&apos;);</div><div class="line">console.log(typeof name); // symbol</div></pre></td></tr></table></figure></p>
<h2 id="Symbol的使用方法"><a href="#Symbol的使用方法" class="headerlink" title="Symbol的使用方法"></a>Symbol的使用方法</h2><p><strong>所有使用可计算属性名的地方，都可以使用Symbol</strong>。如Object.defineProperty等:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">let firstName = Symbol(&quot;first name&quot;);</div><div class="line">// use a computed object literal property</div><div class="line">let person = &#123;</div><div class="line">    [firstName]: &quot;Nicholas&quot;</div><div class="line">&#125;;</div><div class="line">// make the property read only</div><div class="line">Object.defineProperty(person, firstName, &#123; writable: false &#125;);</div><div class="line">let lastName = Symbol(&quot;last name&quot;);</div><div class="line">Object.defineProperties(person, &#123;</div><div class="line">    [lastName]: &#123;</div><div class="line">        value: &quot;Zakas&quot;,</div><div class="line">        writable: false</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="Symbol共享体系"><a href="#Symbol共享体系" class="headerlink" title="Symbol共享体系"></a>Symbol共享体系</h2><p>在不同的代码中共享同一个Symbol，ES6提供了一个可以随时访问的全局Symbol注册表；如果要创建一个共享的Symbol，要使用Symbol.for方法，它只接受一个参数，也就是即将创建的Symbol的字符串标示，这个参数同样也被用作Symbol的描述；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let uid = Symbol.for(&quot;uid&quot;);</div><div class="line">let object = &#123;&#125;;</div><div class="line">object[uid] = &quot;12345&quot;;</div><div class="line">console.log(object[uid]); // &apos;12345&apos;</div><div class="line">console.log(uid);         // &apos;Symbol(uid)&apos;</div></pre></td></tr></table></figure>
<p>Symbol.for首先在全局Symbol注册表中搜索键为’uid’的Symbol，如果存在，直接返回已存在的，否则创建一个新的Symbol，并使用这个键在Symbol全局注册表中注册，随机返回新创建的Symbol。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">let uid = Symbol.for(&quot;uid&quot;);</div><div class="line">let uid2 = Symbol.for(&quot;uid&quot;);</div><div class="line">console.log(uid === uid2); // true</div><div class="line">console.log(uid2);         // &apos;Symbol(uid)&apos;</div></pre></td></tr></table></figure>
<p>还有一个与Symbol共享有关的特性，Symbol.keyFor方法在Symbol全局注册表中检索与Symbol有关的键；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">let uid = Symbol.for(&quot;uid&quot;);</div><div class="line">console.log(Symbol.keyFor(uid)); // uid</div><div class="line">let uid2 = Symbol.for(&quot;uid&quot;);</div><div class="line">console.log(Symbol.keyFor(uid2));// uid</div><div class="line">let uid3 = Symbol(&quot;uid&quot;);</div><div class="line">console.log(Symbol.keyFor(uid3));// undefined</div></pre></td></tr></table></figure>
<p>Symbol全局注册表中不存在uid3这个Symbol(没有通过Symbol.for注册)，返回undefined；</p>
<h2 id="Symbol与类型强制转换"><a href="#Symbol与类型强制转换" class="headerlink" title="Symbol与类型强制转换"></a>Symbol与类型强制转换</h2><p>不能将Symbol强制转换为字符串和数字类型；Symbol在需要逻辑判断表达式中为真；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var uid = Symbol.for(&quot;uid&quot;),</div><div class="line">          desc = uid + &quot;&quot;;  // Cannot convert a Symbol value to a string</div><div class="line">var sum = uid / 1; // Cannot convert a Symbol value to a number</div><div class="line">!!uid; // true</div></pre></td></tr></table></figure>
<h2 id="Symbol属性检索"><a href="#Symbol属性检索" class="headerlink" title="Symbol属性检索"></a>Symbol属性检索</h2><p>Object.keys和Object.getOwnpropertyNames不能检索出Symbol属性，ES6中Object.getOwnpropertySymbols来支持这个功能，返回对象中的所有Symbol属性的数组；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let uid = Symbol.for(&quot;uid&quot;);</div><div class="line">let object = &#123;</div><div class="line">    [uid]: &quot;12345&quot;</div><div class="line">&#125;;</div><div class="line">let symbols = Object.getOwnPropertySymbols(object);</div><div class="line">console.log(symbols.length); // 1</div><div class="line">console.log(symbols[0]);     // &apos;Symbol(uid)&apos;</div><div class="line">console.log(object[symbols[0]]);// &apos;12345&apos;</div></pre></td></tr></table></figure>
<h2 id="通过well-known-Symbol暴露内部操作"><a href="#通过well-known-Symbol暴露内部操作" class="headerlink" title="通过well-known Symbol暴露内部操作"></a>通过well-known Symbol暴露内部操作</h2><p>ES6通过在原型链上定义与Symbol相关的属性来暴露更多的语言内部逻辑；开放了以前JS中常见的内部操作，并通过预定义一些well-known Symbol来表示。每一个这类Symbol都是symbol对象的一个属性，例如Symbol.match</p>
<h4 id="Symbol-hasInstance"><a href="#Symbol-hasInstance" class="headerlink" title="Symbol.hasInstance"></a>Symbol.hasInstance</h4><p>一个在执行instanceof时调用的内部方法，用于检测对象的继承信息；</p>
<p>Function.prototype中有一个Symbol.hasInstance方法，每一个函数都继承了这个方法，用于确定对象是否是函数的实例。该方法被定义为不可写，不可配置并且不可枚举。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Object.getOwnPropertyDescriptor(Function.prototype, Symbol.hasInstance); // &#123;writable: false, enumerable: false, configurable: false, value: ƒ&#125;</div></pre></td></tr></table></figure>
<p>看一段代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Array.hasOwnProperty(Symbol.hasInstance);              // false</div><div class="line">Function.prototype.hasOwnProperty(Symbol.hasInstance); // true</div><div class="line">Array instanceof Function;                             // true</div></pre></td></tr></table></figure></p>
<p>从上面可以看出Array是Function的实例；Function.prototype具有自有属性Symbol.hasInstance，Array没有Symbol.hasInstance;</p>
<p><code>obj instanceof Array</code>实际等价于<code>Array[Symbol.hasInstance](obj)</code>，由于Array没有<code>Symbol.hasInstance</code>，所以会从原型链中寻找，最终在<code>Function.prototype</code>中找到，最终实际执行的就是<code>Function.prototype[Symbol.hasInstance](obj)</code>。</p>
<p>明白了instanceof的实际调用过程，就可以按我们的意愿来定制一些内容，例如定义一个无实例的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function MyObject() &#123;</div><div class="line">    // empty</div><div class="line">&#125;</div><div class="line">Object.defineProperty(MyObject, Symbol.hasInstance, &#123;</div><div class="line">    value: function(v) &#123;</div><div class="line">             return false;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">let obj = new MyObject();</div><div class="line">console.log(obj instanceof MyObject); // false</div></pre></td></tr></table></figure>
<h4 id="Symbol-isConcatSpreadable"><a href="#Symbol-isConcatSpreadable" class="headerlink" title="Symbol.isConcatSpreadable"></a>Symbol.isConcatSpreadable</h4><p>concat元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">let colors1 = [ &quot;red&quot;, &quot;green&quot; ],</div><div class="line">    colors2 = colors1.concat([ &quot;blue&quot;, &quot;black&quot; ]);</div><div class="line">console.log(colors2.length);    // 4</div><div class="line">console.log(colors2); [&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;black&quot;]</div></pre></td></tr></table></figure></p>
<p>concat数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">let colors1 = [ &quot;red&quot;, &quot;green&quot; ],</div><div class="line">    colors2 = colors1.concat([ &quot;blue&quot;, &quot;black&quot; ], &quot;brown&quot;);</div><div class="line">console.log(colors2.length);    // 5</div><div class="line">console.log(colors2);           // [&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;black&quot;,&quot;brown&quot;]</div></pre></td></tr></table></figure></p>
<p>JS规范声明，concat凡是传入了数组参数，就会自动将它们分解成独立元素，在ES6之前，我们根本无法调整这个特性；</p>
<p>Symbol.isConcatSpreadable属性是一个布尔值，如果该属性为true，则表示对象由length属性和数字键，故它的数值型属性应该被独立添加到cancat()调用结果中；与其他well-known Symbol属性不同的是，这个Symbol属性默认情况下不会出现标准对象，它只是一个可选对象，用于增强作用于特定对象类型的concat()方法的功能，有效简化其默认特性；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">let collection = &#123;</div><div class="line">    0: &quot;Hello&quot;,</div><div class="line">    1: &quot;world&quot;,</div><div class="line">    length: 2,</div><div class="line">    [Symbol.isConcatSpreadable]: true</div><div class="line">&#125;;</div><div class="line">let messages = [ &quot;Hi&quot; ].concat(collection);</div><div class="line">console.log(messages.length);    // 3</div><div class="line">console.log(messages);           // [&quot;Hi&quot;,&quot;Hello&quot;,&quot;world&quot;]</div><div class="line"></div><div class="line">let collection1 = &#123;</div><div class="line">    0: &quot;Hello&quot;,</div><div class="line">    1: &quot;world&quot;,</div><div class="line">    length: 2,</div><div class="line">    [Symbol.isConcatSpreadable]: true</div><div class="line">&#125;;</div><div class="line">let messages = [ &quot;Hi&quot; ].concat(collection1);</div><div class="line">console.log(messages.length);    // 2</div><div class="line">console.log(messages);           // [&quot;Hi&quot;,&#123;...&#125;]</div></pre></td></tr></table></figure>
<h4 id="Symbol-match-Symbol-replace-Symbol-search-Symbol-split"><a href="#Symbol-match-Symbol-replace-Symbol-search-Symbol-split" class="headerlink" title="Symbol.match Symbol.replace Symbol.search Symbol.split"></a>Symbol.match Symbol.replace Symbol.search Symbol.split</h4><p>这四个Symbol用在String对应的四个方法String.match/replace/search/split中且当参数为正则表达式时。</p>
<p>可以定义一个对象的这四个Symbol属性方法，这对象就可以代替正则表达式来应用在上面的对应场景中；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">// effectively equivalent to /^.&#123;10&#125;$/ </div><div class="line">let hasLengthOf10 = &#123;</div><div class="line">  [Symbol.match]: function(value) &#123;</div><div class="line">    return value.length === 10 ? [value.substring(0, 10)] : null;</div><div class="line">  &#125;,</div><div class="line">  [Symbol.replace]: function(value, replacement) &#123;</div><div class="line">    return value.length === 10 ? replacement + value.substring(10) : value;</div><div class="line">  &#125;,</div><div class="line">  [Symbol.search]: function(value) &#123;</div><div class="line">    return value.length === 10 ? 0 : -1;</div><div class="line">  &#125;,</div><div class="line">  [Symbol.split]: function(value) &#123;</div><div class="line">    return value.length === 10 ? [&quot;&quot;, &quot;&quot;] : [value];</div><div class="line">  &#125; </div><div class="line">&#125;;</div><div class="line"></div><div class="line">let message1 = &quot;Hello world&quot;, // 11 characters </div><div class="line">message2 = &quot;Hello John&quot;; // 10 characters</div><div class="line">let match1 = message1.match(hasLengthOf10), </div><div class="line">match2 = message2.match(hasLengthOf10);</div><div class="line">console.log(match1); // null </div><div class="line">console.log(match2); // [&quot;Hello John&quot;]</div><div class="line">let replace1 = message1.replace(hasLengthOf10), </div><div class="line">replace2 = message2.replace(hasLengthOf10);</div><div class="line">console.log(replace1); // &quot;Hello world&quot; </div><div class="line">console.log(replace2); // &quot;Hello John&quot;</div><div class="line">let search1 = message1.search(hasLengthOf10), </div><div class="line">search2 = message2.search(hasLengthOf10);</div><div class="line">console.log(search1); // -1 </div><div class="line">console.log(search2); // 0</div><div class="line">let split1 = message1.split(hasLengthOf10), </div><div class="line">split2 = message2.split(hasLengthOf10);</div><div class="line">console.log(split1); // [&quot;Hello world&quot;] </div><div class="line">console.log(split2); // [&quot;&quot;, &quot;&quot;]</div></pre></td></tr></table></figure>
<h4 id="Symbol-toPrimitive"><a href="#Symbol-toPrimitive" class="headerlink" title="Symbol.toPrimitive"></a>Symbol.toPrimitive</h4><p>JS引擎中，经常会尝试将对象转换到相应的原始值，例如比较一个对象与字符串；对象被转换为原始值，会有三种选择：数字，字符串或无类型偏好的值。对于大多数标准对象，当对象被转换为数字时：</p>
<ol>
<li>调用valueOf方法，如果结果为原始值，则返回</li>
<li>否则，调用toString方法，如果结果值为原始值，则返回</li>
<li>如果再无可选值，则抛出异常</li>
</ol>
<p>当对象被转换为字符串时：</p>
<ol>
<li>调用toSring方法，如果结果为原始值，则返回</li>
<li>否则，调用valueOf方法，如果结果值为原始值，则返回</li>
<li>如果再无可选值，则抛出异常</li>
</ol>
<p><strong>大多数情况下，标准对象会将默认模式按数字模式处理（除了Date对象）；默认模式只用于==运算，+运算及给Date构造函数传递一个参数时。</strong></p>
<p>在ES6标准中，通过Symbol.toPrimitive方法可以更改那个暴露出来的原始值；Symbol.toPrimitive被定义在每一个标准类型的原型上，并且规定了当对象被转换为原始值时应该执行的操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function Temperature(degrees) &#123;</div><div class="line">              this.degrees = degrees;</div><div class="line">&#125;</div><div class="line">Temperature.prototype[Symbol.toPrimitive] = function(hint) &#123;</div><div class="line">switch (hint) &#123;</div><div class="line">    case &quot;string&quot;:</div><div class="line">        return this.degrees + &quot;\u00b0&quot;; // degrees symbol</div><div class="line">    case &quot;number&quot;:</div><div class="line">        return this.degrees;</div><div class="line">    case &quot;default&quot;:</div><div class="line">        return this.degrees + &quot; degrees&quot;;</div><div class="line">&#125; &#125;;</div><div class="line">var freezing = new Temperature(32);</div><div class="line">console.log(freezing + &quot;!&quot;);    // &quot;32 degrees!&quot;</div><div class="line">console.log(freezing / 2);      // 16</div><div class="line">console.log(String(freezing));  // &quot;32°&quot;</div></pre></td></tr></table></figure>
<h4 id="Symbol-toStringTag"><a href="#Symbol-toStringTag" class="headerlink" title="Symbol.toStringTag"></a>Symbol.toStringTag</h4><p>当检测一个数据的类型时，可能会用instanceof,这样在使用iframe标签情况下会有一定问题，不同的iframe代表不同的领域，不同领域的构造函数是不同的，当数据传递到不同的领域时，使用instanceof会得不到预期的结果；</p>
<p>这时我们可能会用Object.prototype.toString.call来处理；</p>
<p>如区分原生JSON对象和自建对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function supportsNativeJSON() &#123;</div><div class="line">    return typeof JSON !== &quot;undefined&quot; &amp;&amp;</div><div class="line">        Object.prototype.toString.call(JSON) === &quot;[object JSON]&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在ES6中重新定义了原生对象过去的状态，通过Symbol.toStringTag改变了调用Object.prototype.toString方法时返回的身份标示；这个Symbol所代表的属性在每一个对象中都存在，其定义了调用对象的Object.prototype.toString.call方法时返回的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function Person(name) &#123;</div><div class="line">    this.name = name;</div><div class="line">&#125;</div><div class="line">Person.prototype[Symbol.toStringTag] = &quot;Person&quot;;</div><div class="line">var me = new Person(&quot;Nicholas&quot;);</div><div class="line">console.log(me.toString());                     // [object Person]</div><div class="line">console.log(Object.prototype.toString.call(me)); // [object Person]</div></pre></td></tr></table></figure>
<h4 id="Symbol-unscopables"><a href="#Symbol-unscopables" class="headerlink" title="Symbol.unscopables"></a>Symbol.unscopables</h4><p>The Symbol.unscopables well-known symbol is used to specify an object value of whose own and inherited property names are excluded from the with environment bindings of the associated object.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var keys = [];</div><div class="line"></div><div class="line">with (Array.prototype) &#123;</div><div class="line">  keys.push(&apos;something&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">Object.keys(Array.prototype[Symbol.unscopables]); </div><div class="line">// [&quot;copyWithin&quot;, &quot;entries&quot;, &quot;fill&quot;, &quot;find&quot;, &quot;findIndex&quot;, &quot;includes&quot;, &quot;keys&quot;, &quot;values&quot;]</div></pre></td></tr></table></figure>
<p>也可以改变对象的Symbol.unscopables属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var obj = &#123; </div><div class="line">  foo: 1, </div><div class="line">  bar: 2 </div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj[Symbol.unscopables] = &#123; </div><div class="line">  foo: false, </div><div class="line">  bar: true </div><div class="line">&#125;;</div><div class="line"></div><div class="line">with (obj) &#123;</div><div class="line">  console.log(foo); // 1</div><div class="line">  console.log(bar); // ReferenceError: bar is not defined</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JS/" rel="tag"># JS</a>
          
            <a href="/tags/ES6/" rel="tag"># ES6</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/21/2017-11-21-ES6之解构/" rel="next" title="ES6之解构">
                <i class="fa fa-chevron-left"></i> ES6之解构
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/24/2017-11-24-ES6之类/" rel="prev" title="ES6之class">
                ES6之class <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/abu.jpg"
                alt="cauil" />
            
              <p class="site-author-name" itemprop="name">cauil</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/cauil" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/cauil" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://douban.com/people/cauil" target="_blank" title="DouBan">
                    
                      <i class="fa fa-fw fa-douban"></i>DouBan</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建Symbol"><span class="nav-number">1.</span> <span class="nav-text">创建Symbol</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol的使用方法"><span class="nav-number">2.</span> <span class="nav-text">Symbol的使用方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol共享体系"><span class="nav-number">3.</span> <span class="nav-text">Symbol共享体系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol与类型强制转换"><span class="nav-number">4.</span> <span class="nav-text">Symbol与类型强制转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol属性检索"><span class="nav-number">5.</span> <span class="nav-text">Symbol属性检索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通过well-known-Symbol暴露内部操作"><span class="nav-number">6.</span> <span class="nav-text">通过well-known Symbol暴露内部操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-hasInstance"><span class="nav-number">6.0.1.</span> <span class="nav-text">Symbol.hasInstance</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-isConcatSpreadable"><span class="nav-number">6.0.2.</span> <span class="nav-text">Symbol.isConcatSpreadable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-match-Symbol-replace-Symbol-search-Symbol-split"><span class="nav-number">6.0.3.</span> <span class="nav-text">Symbol.match Symbol.replace Symbol.search Symbol.split</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-toPrimitive"><span class="nav-number">6.0.4.</span> <span class="nav-text">Symbol.toPrimitive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-toStringTag"><span class="nav-number">6.0.5.</span> <span class="nav-text">Symbol.toStringTag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Symbol-unscopables"><span class="nav-number">6.0.6.</span> <span class="nav-text">Symbol.unscopables</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cauil</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
